WHERE ug_group = 'bot'
UNION
-- Get inactive bots
SELECT ufg_user AS user_id, ufg_group AS user_group
FROM user_former_groups
WHERE ufg_group = 'bot'
UNION
-- Get user ids with bot categories in their user pages
SELECT user.user_id, 'bot' AS user_group
FROM user INNER JOIN (
-- all user page names with bot category
SELECT REPLACE(page.page_title, '_', ' ') AS user_name
FROM page INNER JOIN (
-- page ids with bot categories
SELECT DISTINCT cl_from AS page_id
FROM categorylinks
WHERE cl_to REGEXP '_(bot_flag|bots)(_|$)'
AND cl_type = 'page'
) AS bot_cat ON page.page_id=bot_cat.page_id
WHERE page_namespace = 2
) AS bot_name ON user.user_name=bot_name.user_name
) AS bots RIGHT JOIN image ON bots.user_id = image.img_user
GROUP BY LEFT(img_timestamp, 6), user_group;
"
message("Using SSH tunnel & connection to Analytics-Store...")
bot_by_month <- wmf::mysql_read(query, "commonswiki", con = con)
message("Create an auto-closing SSH tunnel in the backgroud")
system("ssh -f -o ExitOnForwardFailure=yes stat1006.eqiad.wmnet -L 3307:analytics-store.eqiad.wmnet:3306 sleep 10")
library(RMySQL)
con <- dbConnect(MySQL(), host = "127.0.0.1", group = "client", dbname = "commonswiki", port = 3307)
# Create query to count the number of bot and user contributions by media type.
query <- "
SELECT img_media_type, user_group, COUNT(*) AS n_files
FROM (
-- Get active bots
SELECT ug_user AS user_id, ug_group AS user_group
FROM user_groups
WHERE ug_group = 'bot'
-- Get inactive bots
UNION
SELECT ufg_user AS user_id, ufg_group AS user_group
FROM user_former_groups
WHERE ufg_group = 'bot'
UNION
-- Get user ids with bot categories in their user pages
SELECT user.user_id, 'bot' AS user_group
FROM user INNER JOIN (
-- select all user page names with bot category
SELECT REPLACE(page.page_title, '_', ' ') AS user_name
FROM page INNER JOIN (
-- select page ids with bot categories
SELECT DISTINCT cl_from AS page_id
FROM categorylinks
WHERE cl_to REGEXP '_(bot_flag|bots)(_|$)'
AND cl_type = 'page'
) AS bot_cat ON page.page_id=bot_cat.page_id
WHERE page_namespace = 2
) AS bot_name ON user.user_name=bot_name.user_name
) AS bots RIGHT JOIN image ON bots.user_id = image.img_user
GROUP BY img_media_type, user_group;
"
load("data/bot_by_mediatype.Rdata")
bot_by_mediatype <- bot_by_mediatype %>%
mutate(user_group = if_else(is.na(user_group), "user", user_group),
img_media_type = tolower(img_media_type),
proportion = paste0(round(n_files/sum(n_files), 4)*100, "%"))
bot_by_mediatype %>%
group_by(user_group) %>%
summarize(n_files = sum(n_files)) %>%
mutate(proportion = n_files/sum(n_files))
knitr::kable(bot_by_mediatype)
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
# Create query to count the number of bot and user contributions by month.
query <- "
SELECT LEFT(img_timestamp, 6) AS yr_month, user_group, COUNT(*) AS n_files
FROM (
-- Get active bots
SELECT ug_user AS user_id, ug_group AS user_group
FROM user_groups
WHERE ug_group = 'bot'
UNION
-- Get inactive bots
SELECT ufg_user AS user_id, ufg_group AS user_group
FROM user_former_groups
WHERE ufg_group = 'bot'
UNION
-- Get user ids with bot categories in their user pages
SELECT user.user_id, 'bot' AS user_group
FROM user INNER JOIN (
-- all user page names with bot category
SELECT REPLACE(page.page_title, '_', ' ') AS user_name
FROM page INNER JOIN (
-- page ids with bot categories
SELECT DISTINCT cl_from AS page_id
FROM categorylinks
WHERE cl_to REGEXP '_(bot_flag|bots)(_|$)'
AND cl_type = 'page'
) AS bot_cat ON page.page_id=bot_cat.page_id
WHERE page_namespace = 2
) AS bot_name ON user.user_name=bot_name.user_name
) AS bots RIGHT JOIN image ON bots.user_id = image.img_user
GROUP BY LEFT(img_timestamp, 6), user_group;
"
message("Using SSH tunnel & connection to Analytics-Store...")
bot_by_month <- wmf::mysql_read(query, "commonswiki", con = con)
message("Closing connection...")
wmf::mysql_close(con)
save(bot_by_month, file = "data/bot_by_month.RData")
load("data/bot_by_month.RData")
bot_by_month <- bot_by_month %>%
mutate(year_month = zoo::as.yearmon(yr_month, "%Y%m"),
user_group = if_else(is.na(user_group), "user", user_group)) %>%
arrange(year_month, user_group) %>%
group_by(user_group) %>%
mutate(total_files = cumsum(n_files)) %>%
group_by(yr_month) %>%
mutate(proportion = total_files / sum(total_files))
load("data/bot_by_month.RData")
bot_by_month <- bot_by_month %>%
mutate(year_month = zoo::as.yearmon(yr_month, "%Y%m"),
user_group = if_else(is.na(user_group), "user", user_group)) %>%
arrange(year_month, user_group) %>%
group_by(user_group) %>%
mutate(total_files = cumsum(n_files)) %>%
group_by(yr_month) %>%
mutate(proportion = total_files / sum(total_files))
library("polloi")
bot_by_month %>%
ggplot(aes(x=year_month, y=total_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Cumulative sum of files", title = "Cumulative sum of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_bar(stat = 'identity', position = 'dodge', alpha = 2/3) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_col(stat = 'identity', position = 'dodge', alpha = 2/3) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
tail(bot_by_month)
knitr::opts_chunk$set(echo = TRUE)
set.seed(0)
library(tidyverse)
message("Create an auto-closing SSH tunnel in the backgroud")
system("ssh -f -o ExitOnForwardFailure=yes stat1006.eqiad.wmnet -L 3307:analytics-store.eqiad.wmnet:3306 sleep 10")
library(RMySQL)
con <- dbConnect(MySQL(), host = "127.0.0.1", group = "client", dbname = "commonswiki", port = 3307)
knitr::opts_chunk$set(echo = TRUE)
set.seed(0)
library(tidyverse)
message("Create an auto-closing SSH tunnel in the backgroud")
system("ssh -f -o ExitOnForwardFailure=yes stat1006.eqiad.wmnet -L 3307:analytics-store.eqiad.wmnet:3306 sleep 10")
library(RMySQL)
con <- dbConnect(MySQL(), host = "127.0.0.1", group = "client", dbname = "commonswiki", port = 3307)
setwd("~/Code/SDoC-Baseline-Metrics-Redux/T185365")
message("Create an auto-closing SSH tunnel in the backgroud")
system("ssh -f -o ExitOnForwardFailure=yes stat1006.eqiad.wmnet -L 3307:analytics-store.eqiad.wmnet:3306 sleep 10")
library(RMySQL)
con <- dbConnect(MySQL(), host = "127.0.0.1", group = "client", dbname = "commonswiki", port = 3307)
# Create query to count the number of bot and user contributions by media type.
query <- "
SELECT img_media_type, user_group, COUNT(*) AS n_files
FROM (
-- Get active bots
SELECT ug_user AS user_id, ug_group AS user_group
FROM user_groups
WHERE ug_group = 'bot'
-- Get inactive bots
UNION
SELECT ufg_user AS user_id, ufg_group AS user_group
FROM user_former_groups
WHERE ufg_group = 'bot'
UNION
-- Get user ids with bot categories in their user pages
SELECT user.user_id, 'bot' AS user_group
FROM user INNER JOIN (
-- select all user page names with bot category
SELECT REPLACE(page.page_title, '_', ' ') AS user_name
FROM page INNER JOIN (
-- select page ids with bot categories
SELECT DISTINCT cl_from AS page_id
FROM categorylinks
WHERE cl_to REGEXP '_(bot_flag|bots)(_|$)'
AND cl_type = 'page'
) AS bot_cat ON page.page_id=bot_cat.page_id
WHERE page_namespace = 2
) AS bot_name ON user.user_name=bot_name.user_name
) AS bots RIGHT JOIN image ON bots.user_id = image.img_user
GROUP BY img_media_type, user_group;
"
message("Using SSH tunnel & connection to Analytics-Store...")
bot_by_mediatype <- wmf::mysql_read(query, "commonswiki", con = con)
message("Closing connection...")
wmf::mysql_close(con)
save(bot_by_mediatype, file = "data/bot_by_mediatype.RData")
load("data/bot_by_mediatype.Rdata")
bot_by_mediatype <- bot_by_mediatype %>%
mutate(user_group = if_else(is.na(user_group), "user", user_group),
img_media_type = tolower(img_media_type),
proportion = paste0(round(n_files/sum(n_files), 4)*100, "%"))
bot_by_mediatype %>%
group_by(user_group) %>%
summarize(n_files = sum(n_files)) %>%
mutate(proportion = n_files/sum(n_files))
knitr::kable(bot_by_mediatype)
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
dev.copy("figures/bot_by_mediatype.png")
dev.copy(png, "figures/bot_by_mediatype.png")
dev.copy(png, filename= "figures/bot_by_mediatype.png")
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_mediatype_omitbitmap.png", plot = bot_by_mediatype_omitbitmap)
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
imagetypeplot <- bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_mediatype_omitbitmap.png", plot = imagetypeplot)
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
# Create query to count the number of bot and user contributions by month.
query <- "
SELECT LEFT(img_timestamp, 6) AS yr_month, user_group, COUNT(*) AS n_files
FROM (
-- Get active bots
SELECT ug_user AS user_id, ug_group AS user_group
FROM user_groups
WHERE ug_group = 'bot'
UNION
-- Get inactive bots
SELECT ufg_user AS user_id, ufg_group AS user_group
FROM user_former_groups
WHERE ufg_group = 'bot'
UNION
-- Get user ids with bot categories in their user pages
SELECT user.user_id, 'bot' AS user_group
FROM user INNER JOIN (
-- all user page names with bot category
SELECT REPLACE(page.page_title, '_', ' ') AS user_name
FROM page INNER JOIN (
-- page ids with bot categories
SELECT DISTINCT cl_from AS page_id
FROM categorylinks
WHERE cl_to REGEXP '_(bot_flag|bots)(_|$)'
AND cl_type = 'page'
) AS bot_cat ON page.page_id=bot_cat.page_id
WHERE page_namespace = 2
) AS bot_name ON user.user_name=bot_name.user_name
) AS bots RIGHT JOIN image ON bots.user_id = image.img_user
GROUP BY LEFT(img_timestamp, 6), user_group;
"
message("Create an auto-closing SSH tunnel in the backgroud")
system("ssh -f -o ExitOnForwardFailure=yes stat1006.eqiad.wmnet -L 3307:analytics-store.eqiad.wmnet:3306 sleep 10")
library(RMySQL)
con <- dbConnect(MySQL(), host = "127.0.0.1", group = "client", dbname = "commonswiki", port = 3307)
message("Using SSH tunnel & connection to Analytics-Store...")
bot_by_month <- wmf::mysql_read(query, "commonswiki", con = con)
message("Closing connection...")
wmf::mysql_close(con)
save(bot_by_month, file = "data/bot_by_month.RData")
load("data/bot_by_month.RData")
bot_by_month <- bot_by_month %>%
mutate(year_month = zoo::as.yearmon(yr_month, "%Y%m"),
user_group = if_else(is.na(user_group), "user", user_group)) %>%
arrange(year_month, user_group) %>%
group_by(user_group) %>%
mutate(total_files = cumsum(n_files)) %>%
group_by(yr_month) %>%
mutate(proportion = total_files / sum(total_files))
library("polloi")
bot_by_month %>%
ggplot(aes(x=year_month, y=total_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Cumulative sum of files", title = "Cumulative sum of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
library("polloi")
monthplot <- bot_by_month %>%
ggplot(aes(x=year_month, y=total_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Cumulative sum of files", title = "Cumulative sum of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_cumsum.png", plot = monthplot)
month_plot <- bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_col(stat = 'identity', position = 'dodge', alpha = 2/3) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_nfiles.png", plot = month_plot)
month_plot <- bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_col(stat = 'identity', position = 'dodge', alpha = 2/3) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_col(stat = 'identity', position = 'dodge', alpha = 2/3) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
monthplot<- bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_nfiles.png", plot = monthplot)
bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, fill=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
monthplot <- bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_proportion.png", plot = monthplot)
monthplot <- bot_by_month %>%
ggplot(aes(x=year_month, y=proportion, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = scales::percent) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Proportion of files (Cumulative)", title = "Proportion of files contributions on Wikimedia Commons by bots and users") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
tail(bot_by_month)
library("polloi")
bot_by_month %>%
ggplot(aes(x=year_month, y=total_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Cumulative sum of files", title = "Cumulative sum of file contributions on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
month <- bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_n_files", plot = month)
month <- bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of files (Non-Cumulative)", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_n_files.png", plot = month)
month <- bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of new files", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
ggsave("bot_by_month_n_files.png", plot = month)
setwd("~/Code/SDoC-Baseline-Metrics-Redux/T185365")
bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of new files", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_month %>%
ggplot(aes(x=year_month, y=n_files, group=user_group, color=user_group)) +
geom_line(size = 1) +
zoo::scale_x_yearmon(breaks = seq(min(bot_by_month$year_month), max(bot_by_month$year_month), by = 1)) +
scale_y_continuous(labels = polloi::compress) +
scale_color_brewer("User Group", palette = "Set2") +
labs(x = "Month", y = "Number of new files", title = "Total number of newly uploaded files on Wikimedia Commons by users and bots") +
theme_minimal(base_size = 10) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
bot_by_mediatype_omitbitmap <- bot_by_mediatype[bot_by_mediatype$img_media_type != "bitmap",]
bot_by_mediatype_omitbitmap %>%
ggplot(aes(x=img_media_type, y=n_files, group=user_group, fill=user_group)) +
geom_col(position = "dodge") +
scale_color_brewer("User Group", palette = "Set1") +
labs(x = "Media type", y = "No. of files", title = "File contributions on Wikimedia Commons by non-bitmap media types") +
theme_minimal(base_size = 11) +
theme(legend.position = "bottom", strip.placement = "outside", axis.text.x = element_text(angle = 90))
